<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSV Analysis Simulation</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f7f7f7;
      padding: 20px;
    }
    h2 {
      color: #333;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
      margin-bottom: 20px;
      table-layout: fixed;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 5px 10px;
      text-align: left;
      overflow: hidden;        
      white-space: nowrap;      
      text-overflow: ellipsis;  
    }
    th {
      background: #eee;
    }
    .highlight {
      background: #ffff99;
    }
    #plot img {
      margin-top: 15px;
      max-width: 100%;
      border: 1px solid #ccc;
    }
    button {
      padding: 8px 16px;
      font-size: 14px;
      cursor: pointer;
      margin-bottom: 20px;
    }
  </style>
</head>
<body>
  <h2>Simulated CSV Analysis</h2>
  <button id="start">Start Analysis</button>

  <h3>Current Row:</h3>
  <table id="csvTable">
    <thead>
      <tr id="tableHeaders"></tr>
    </thead>
    <tbody id="tableBody">
      <tr id="currentRow"></tr>
    </tbody>
  </table>

  <h3>Analysis Output:</h3>
  <div id="plot"></div>

  <script>
    const csvFiles = ["august.csv", "june.csv", "july.csv"];
    const tableHeaders = ["Date", "Location", "Time Started", "Time Restored", "Cause"];
    
    const tableHeadRow = document.getElementById("tableHeaders");
    tableHeaders.forEach(h => {
      const th = document.createElement("th");
      th.textContent = h;
      tableHeadRow.appendChild(th);
    });

    const currentRow = document.getElementById("currentRow");

    async function fetchCSV(file) {
      const res = await fetch(file);
      const text = await res.text();
      const rows = text.trim().split("\n").slice(1);
      return rows.map(r => r.split(","));
    }

    async function simulateAnalysis() {
      document.getElementById("start").disabled = true;
      currentRow.innerHTML = "";
      const allData = [];

      for (const file of csvFiles) {
        const rows = await fetchCSV(file);
        allData.push(...rows);
      }

      for (let i = 0; i < allData.length; i++) {
        currentRow.innerHTML = "";
        allData[i].forEach(cell => {
          const td = document.createElement("td");
          td.textContent = cell;
          currentRow.appendChild(td);
        });
        await new Promise(res => setTimeout(res, 5));
      }

      const plotDiv = document.getElementById("plot");
      plotDiv.innerHTML = "";
      const img = document.createElement("img");
      img.src = "r.png";
      img.alt = "Simulated R Plot";
      plotDiv.appendChild(img);
    }

    document.getElementById("start").onclick = simulateAnalysis;
  </script>
</body>
</html>
